<html>
    <head>
        <link rel="stylesheet" href="styles/styles.css">
        <title>GESTIONECOSTI</title>
        <meta charset="UTF-8">
         <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    </head>
    <body>
        <form id="acquisto">
            <label>Oggetto acquistato: <input type="text" id="object"></label><br><br>
            <label>Data d'acquisto: <input type="date" id="buyDate"></label><br><br>
            <label>Data di vendita: <input type="date" id="sellDate"></label><br><br>
            <label>Importo d'acquisto: <input type="number" id="buyAmount"></label><br><br>
            <label>Importo di vendita: <input type="number" id="sellAmount"></label><br><br>
            <button type="submit" id="inserisci">Inserisci</button>
        </form>

        <label>Carica file:
            <input type="file" id="uploadFile" accept=".xlsx" />
        </label>

        <script>

            let workbook, worksheetName;

            // Carica automaticamente file.xlsx dalla root
            window.addEventListener('DOMContentLoaded', () => {
            fetch('gestionecosti.xlsx')
                .then(response => {
                if (!response.ok) throw new Error('File non trovato nella root');
                return response.arrayBuffer();
                })
                .then(arrayBuffer => {
                workbook = XLSX.read(arrayBuffer, { type: 'array' });
                worksheetName = workbook.SheetNames[0];
                alert("File caricato dalla root!");
                document.getElementById('dataForm').style.display = 'block';
                })
                .catch(error => {
                alert("Errore nel caricamento del file: " + error.message);
                });
            });



            document.getElementById('acquisto').addEventListener('submit', function (e) {
            e.preventDefault();

            // Recupera i dati dal form
            const object = document.getElementById('object').value;
            const buyDate = document.getElementById('buyDate').value;
            const sellDate = document.getElementById('sellDate').value;
            const buyAmount = document.getElementById('buyAmount').value;
            const sellAmount = document.getElementById('sellAmount').value;

            // Crea i dati per il foglio Excel
            const data = [
                ["Oggetto acquistato", "Data d'acquisto", "Data di vendita", "Importo d'acquisto", "Importo di vendita"],
                [object, buyDate, sellDate, buyAmount, sellAmount]
            ];

            // Crea il foglio e la cartella
            const worksheet = XLSX.utils.aoa_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Utente");

            // Salva il file
            XLSX.writeFile(workbook, "dati_utente.xlsx");
            });
        </script>
    </body>
</html>