<html>
    <head>
        <link rel="stylesheet" href="styles/styles.css">
        <title>GESTIONECOSTI</title>
        <meta charset="UTF-8">
         <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    </head>
    <body >

        <h1>Form di acquisto</h1>
        
        <div id="main">
            <form id="acquisto" action="" method="post">
                <label>Oggetto acquistato: <input type="text" id="object"></label><br><br>
                <label>Numero ordine: <input type="text" id="orderNum"></label><br><br>
                <label>Data d'acquisto: <input type="date" id="buyDate"></label><br><br>
                <label>Data di vendita: <input type="date" id="sellDate"></label><br><br>
                <label>Importo d'acquisto: <input type="number" id="buyAmount"></label><br><br>
                <label>Importo di vendita: <input type="number" id="sellAmount"></label><br><br>
                <button type="submit">Inserisci</button>
            </form>
        </div>
        <br>
        <br>
        <h1>Form di vendita</h1>
        <br>
        <br>
        <div>
            <form id="vendita" action="" method="post">
                <label>Numero ordine: <input type="text" id="orderNum"></label><br><br>
                <label>Data di vendita: <input type="date" id="sellDate"></label><br><br>
                <label>Importo di vendita: <input type="number" id="sellAmount"></label><br><br>
                <button type="submit">Inserisci</button>
            </form>
        </div>

        <br>
        <br>
        <button onclick="pagRiepilogo()">Vedi riepilogo</button>

        <script>

            document.getElementById('acquisto').addEventListener('submit', function (e) {
                e.preventDefault();
                // Recupera i dati dal form

                const object = document.getElementById('object').value;
                const orderNum = document.getElementById('orderNum').value;
                const buyDate = document.getElementById('buyDate').value;
                const sellDate = document.getElementById('sellDate').value;
                const buyAmount = document.getElementById('buyAmount').value;
                const sellAmount = document.getElementById('sellAmount').value;

                // Invia i dati al server
                fetch('/scrivi', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ object, orderNum, buyDate, sellDate, buyAmount, sellAmount })
                })
                .then(res => res.text())
                .then(msg => {
                    alert(msg);
                    document.getElementById('acquisto').reset();
                })
                .catch(err => {
                    console.error(err);
                    alert('Errore nell\'invio dei dati');
                });
            });

            document.getElementById('vendita').addEventListener('submit', function (e) {
                e.preventDefault();
                // Recupera i dati dal form

                const orderNum = document.getElementById('orderNum').value;
                const sellDate = document.getElementById('sellDate').value;
                const sellAmount = document.getElementById('sellAmount').value;

                // Invia i dati al server
                fetch('/scrivi', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ orderNum, sellDate, sellAmount })
                })
                .then(res => res.text())
                .then(msg => {
                    alert(msg);
                    document.getElementById('vendita').reset();
                })
                .catch(err => {
                    console.error(err);
                    alert('Errore nell\'invio dei dati');
                });
            });
                
            
             
            function home(){
                window.location.href = '/';
            }

            function riepilogo(){
                window.location.href = '/riepilogo';
            }

            function pagRiepilogo(){
               window.location.href = `/pagRiepilogo`;
            }

        </script>
    </body>
</html>